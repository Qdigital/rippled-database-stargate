var ledger = {
        "ledger_hash": "E14C90C59CA0198D50CC2A863BD183680F8EFE3C75DA50BBD39F9D89A46B76A2",
        "ledger_index": 6409247,
        "parent_hash": "49C7DF14A2F07018A032D757838C19DAB992D8A0D044BDFFE57E938B8AE0AB50",
        "total_coins": 99999993536372130,
        "close_time_res": 10,
        "accounts_hash": "F9824325C14F1C34A8C5AF283A887A8DCBFE218AEEFCCA843281596B1C350C01",
        "transactions_hash": "99B6EDE9F3C06B1AC63C9E71015BC02AC138DFC7756B3C5B8F8C2AA83E0C03FC",
        "close_time": 1399071870,
        "close_time_human": "2014-05-02T23:04:30+00:00",
        "transactions": [
            {
                "hash": "93AD2A563879DF73F1EADEF6ABDF1D268B4C9ABC30536395CF9F9435055329AC",
                "date": "2014-05-02T23:04:30+00:00",
                "ledger_index": 6409247,
                "tx": "120007220000000024000010a1201b0061cc2764400000003b9aca0065d491ceea9109be900000000000000000000000005553440000000000dd39c650a96eda48334e70cc4a85b8b2e8502cd368400000000000000a7321028f763cd13a01bb93aa2387d9ccd33d3ccc5926933a13ab6d0689da299582e4477447304502207058b77d91807c9b459028b51b0145d13d5f1e181a0728c83d6366abf70a823602210097baa2a36d3b418089019f7a30a4b0851ec471cf73faae59f67d52da42db1b068114601ea3c6b37f2c0d1d1251516ec075e577093376",
                "meta": "201c00000002f8e5110061250061cc1d55e0ecb6343e0b45338971942e2df624f7873dece172206e73b18ed83d5e542fab561ceb03445dbdc181dcb07e6f8ecfb2934cc05e1d601f9b3136da72bd9acb48d0e624000010a1624000000002160290e1e7220000000024000010a22d000000026240000000021602868114601ea3c6b37f2c0d1d1251516ec075e577093376e1e1f103107b"
            },
            {
                "hash": "DB53018AAFBD1E4AE9C69C82AAB6535E9A9A969F1133E4F79DAE58319C9CFD63",
                "date": "2014-05-02T23:04:30+00:00",
                "ledger_index": 6409247,
                "tx": "1200002200000000240011ae405011360bdce9a57b49f786f0d9bc9eed4d14000000000000000000000000000000006140000000065df0a26840000000000000fa732103d7895a6ae8f78a1b136903abccdc7eceb1c7c5b2a37dbe47b6c268b9cb461571744730450220185d3c4579a083c3aa25824b8c62a8e5a9d07f43420e89afc3e2ef71592a4862022100ef0e11f275d29296daac59685dfa00ae89dfb1b6c334c9617c87ccc4c2688ab58114921a8d4667fec23671825d2fdde08b719dc77c2583148797a79e6019eac76398cb302ab02262400281ff",
                "meta": "201c00000001f8e5110061250061be185590c8c28e62bb62b457ef5df5bda49730a5b39b49d8dcc9deef9c6722634e279d5628eb3885f52be0d9aa0ceec4a1323f25b825f92c2c5dd65b963c1bfcaf4b6c47e662400000043657d6aae1e7220000000024000000482d0000000d62400000043cb5c74c81148797a79e6019eac76398cb302ab02262400281ffe1e1e5110061250061cc1e5558b1463a9bf2986e0528e738e42c7772cbf7081913041dbf56570c97dd0e6794562cf524584fc1dda14abf3af2134f54f29ba2ad9206bd9436e4426a3afbd298dce6240011ae406240001100525f9272e1e72200000000240011ae412d0000000062400011004c01a0d68114921a8d4667fec23671825d2fdde08b719dc77c25e1e1f1031000"
            }
        ]
    };

var badTx = {
    "hash": "ABF77E680C8E88225D74FF54F06993C7B3A3D49A896BE62D017E4F4D05832AE9",
    "date": "2014-05-02T23:04:30+00:00",
    "ledger_index": 6409247,
    "tx": "1200002280000000230001e24024000000f12e0009fbf150116369616f6369616f6369616f6369616f6369616f6369616f6369616f6369616f61400000000000000168400000000000000a732103d77895d27f16c3469e38944052582d3c7b8a54a110ff9b723e608c00d3fe6f7274463044022079ff99bbc0d308e26f65fdc6044995a9795ff16a810721ac1ab8db9a4acbbbce022076876823b9536ed5ba5139d5446d99be7e0474daadf5fbbab286c9578f37ddae8114b99eb6f65d0ded9584523799b5a1be3081d6b8498314bcc46f3f4f44001eb0564bc97455f730165f1444f97ce1f1",
    "meta": "201c00000000f8e5110061250061cb2d55dfe113d4089e97c23e0cfdd900e3ba3352802a7424c313ddb949f7fabeab30e756d9b60c0ba6a99b887beda6cd633c03240166bca68bbf7c2e1c536dc1b1776720e6624000000005f767d1e1e72200000000240000000b2d00000001624000000005f767d28114bcc46f3f4f44001eb0564bc97455f730165f1444e1e1e5110061250061cb2d55dfe113d4089e97c23e0cfdd900e3ba3352802a7424c313ddb949f7fabeab30e756dc5391e902ee927274f034857d65fa998c4df1caf835d860bfd5b5c8f53cf3e6e624000000f16240000000037304f8e1e7220000000024000000f22d000000036240000000037304ed770b6578616d706c652e636f6d8114b99eb6f65d0ded9584523799b5a1be3081d6b849e1e1f1031000"
}

var binary = require('ripple-binary-codec');
var HBase  = require('./client');
var hbase  = new HBase();


//form transactions for hash calc
ledger.transactions.forEach(function(tx, i) {
  var transaction      = binary.decode(tx.tx.toUpperCase());
  transaction.metaData = binary.decode(tx.meta.toUpperCase());
  transaction.hash = tx.hash;
  ledger.transactions[i] = transaction;
});

hbase.saveLedger(ledger, function(err, resp) {
  console.log(err, resp);
  process.exit();
});
